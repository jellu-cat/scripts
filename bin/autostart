#!/bin/sh

############################################################

# Script Name     :   Autostart
# Description     :   WM-agnostic script for setting up
#                     the environment
# Args            :   none
# Author          :   Jellu Cat

############################################################

#############
# Functions #
#############

# Runs a program only if it isn't running
run (){
    local name=$1

    if (pidof "$name" > /dev/null); then
        echo "$name already running!"
    else
        echo "Running $name"
       `$name` &
    fi
}

# Runs a program killing any other instances, useful to restart after
# changing the configuration files
initialize (){
    local name=$1

    if (pidof "$name" > /dev/null); then
        killall "$name"
        echo "$name killed"
    fi

    if [ "$name" = "sxhkd" ]; then
        sxhkd -c ~/.config/sxhkd/sxhkdrc &
        sxhkd -c ~/.config/sxhkd/bsphkd &
        echo "Running $name"
    else
       `$name` &
        echo "Running $name"
    fi
}

# Wallpaper
~/.fehbg &

# Running some essential programs
run compton
run redshift
initialize sxhkd
run copyq

killall lemonbar
( bash lemonpie | lemonbar -p -g 1366x22+0+0 -F#151515 -B#F2F2E9 -f "Iosevka Nerd Font"-12 -f FontAwesome-11 ) &
stalonetray &

setxkbmap latam &
xmodmap ~/.Xmodmap &

# The status bar is the last thing loaded
