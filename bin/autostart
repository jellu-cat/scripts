#!/bin/sh

############################################################

# Script Name     :   Autostart
# Description     :   WM-agnostic script for setting up
#                     the environment
# Args            :   none
# Author          :   Jellu Cat

############################################################

#############
# Functions #
#############

# Runs a program only if it isn't running
run (){
    local name=$1

    if (pidof "$name" > /dev/null); then
        echo "$name already running!"
    else
        echo "Running $name"
       `$name` &
    fi
}

# Runs a program killing any other instances, useful to restart after
# changing the configuration files
initialize (){
    local name=$1

    if (pidof "$name" > /dev/null); then
        killall "$name"
        echo "$name killed"
    fi

    if [ "$name" = "sxhkd" ]; then
        sxhkd -c ~/.config/sxhkd/sxhkdrc &
        sxhkd -c ~/.config/sxhkd/bsphkd &
        echo "Running $name"
    else
       `$name` &
        echo "Running $name"
    fi
}

# Wallpaper
~/.fehbg &

# Running some essential programs
run compton
initialize redshift
initialize sxhkd
initialize copyq

# lemonpie
initialize polybar
initialize stalonetray &

emacs --daemon
